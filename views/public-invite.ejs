<%- include("partials/header") %>

<section class="panel glass-panel">
  <p class="text-xs uppercase tracking-[0.3em] text-slate-400">Anonymous prom invite</p>
  <h2 class="mt-3 text-2xl font-semibold text-[#c8ccd4]">A message found you</h2>
  <p class="mt-2 text-sm text-slate-300">Someone wants to get to know you. The sender's name is hidden.</p>

  <div class="detail-grid mt-6">
    <div class="glass-card p-5">
      <h3 class="text-sm uppercase tracking-[0.3em] text-slate-400">Pickup line</h3>
      <p class="mt-3 quote">“<%= invite.message %>”</p>
    </div>
    <div class="glass-card p-5">
      <h3 class="text-sm uppercase tracking-[0.3em] text-slate-400">Fun questions</h3>
      <p class="mt-3 text-slate-200"><%= invite.questions.q1 || "—" %></p>
      <p class="mt-2 text-slate-200"><%= invite.questions.q2 || "—" %></p>
    </div>
  </div>

  <% if (invite.status !== "pending") { %>
  <div class="status-banner status-<%= invite.status %> mt-6">
    This invite already has a response.
  </div>
  <% } else { %>
  <div class="divider"></div>
  <form class="form" action="/i/<%= invite.secretToken %>" method="POST">
    <label>
      Rate the pickup line (1-10)
      <input type="number" name="rating" min="1" max="10" required class="input-field" />
    </label>
    <label>
      Comment / review
      <textarea name="comment" rows="3" class="textarea-field" placeholder="Your thoughts..."></textarea>
    </label>
    <div>
      <p class="text-sm text-slate-300">
        Would you consider going on prom with this person, if you get to know them more?
      </p>
      <div class="choice-grid mt-3">
        <label class="choice-card">
          <input type="radio" name="consider" value="no" required />
          <span class="choice-card__content choice-muted">Not my vibe</span>
        </label>
        <label class="choice-card">
          <input type="radio" name="consider" value="yes" required />
          <span class="choice-card__content choice-yes">I'm interested...</span>
        </label>
      </div>
    </div>
    <div id="contactFields" class="accordion">
      <div class="grid gap-4 mt-4">
        <label>
          Phone number
          <input type="text" name="phone" class="input-field" placeholder="Your phone number" />
        </label>
        <label>
          Instagram handle
          <input type="text" name="insta" class="input-field" placeholder="@yourhandle" />
        </label>
      </div>
    </div>
    <button class="btn btn-primary" type="submit">Submit response</button>
  </form>
  <% } %>
</section>

<script>
  const radios = document.querySelectorAll("input[name='consider']");
  const contactFields = document.getElementById("contactFields");
  radios.forEach((radio) => {
    radio.addEventListener("change", (e) => {
      if (e.target.value === "yes") {
        contactFields.classList.add("is-open");
      } else {
        contactFields.classList.remove("is-open");
      }
    });
  });
</script>

<%- include("partials/footer") %>

